#include <stdio.h>
#include "SM3.h"
#include "SM4.h"

void SM3_SelfTest() {
    unsigned char Msg1[3] = {0x61,0x62,0x63};
    int MsgLen1 = 3;
    char MsgHash1[64];
    unsigned char Msg2[64] = {0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,
                              0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,
                              0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,
                              0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64};
    int MsgLen2 = 64;
    char MsgHash2[32] = {0};
    SM3_256(Msg1, MsgLen1, MsgHash1);
    SM3_256(Msg2, MsgLen2, MsgHash2);
    printf("MsgHash1 = %s\n", MsgHash1);
    printf("MsgHash2 = %s\n", MsgHash2);
}

void SM4_SelfTest(){
    int i;
    unsigned char key[16] =   {0x01, 0x23, 0x45, 0x67,
                               0x89, 0xab, 0xcd, 0xef,
                               0xfe, 0xdc, 0xba, 0x98,
                               0x76, 0x54, 0x32, 0x10};
    unsigned char plain[16] =  {0x01, 0x23, 0x45, 0x67,
                               0x89, 0xab, 0xcd, 0xef,
                               0xfe, 0xdc, 0xba, 0x98,
                               0x76, 0x54, 0x32, 0x10};
    unsigned char cipher[16] = {0x68, 0x1e, 0xdf, 0x34,
                               0xd2, 0x06, 0x96, 0x5e,
                               0x86, 0xb3, 0xe9, 0x4f,
                               0x53, 0x6e, 0x42, 0x46};
    unsigned char En_output[16];
    unsigned char De_output[16];
    printf("%x\n", key[0]);
    SM4_Encrypt(key, plain, En_output);
    for(i = 0; i < 16; ++i){
        printf("%02x ", En_output[i]);
    }
    //SM4_Decrypt(key, cipher, De_output);
}

int main () {
    //SM3_SelfTest();
    SM4_SelfTest();
    return 0;
}